What I learned that was new was the value of enforcing data quality at the database level with constraints rather than relying solely on application logic. Adding CHECK (price > 0) and CHECK (quantity > 0) ensures invalid values cannot be inserted. Since I had practiced CTEs and window functions last month while preparing for interviews, I didn’t have much difficulty with them.

The hardest part was the last query, which combined a window function, a CTE, and joins. I had to iterate on my approach to get it right. Another issue was that my query for “customers who ordered more than two different products” initially returned no rows because each customer had only two distinct products in the sample data. The fix was to add a third distinct product for a few customers so the HAVING COUNT(DISTINCT product_id) > 2 condition would surface results.